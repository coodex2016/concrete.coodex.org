
<!DOCTYPE HTML>
<html lang="zh-hans" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>计费框架 · Coodex libraries</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        <meta name="author" content="Shen Hainan <jujus.shen@126.com>">
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-back-to-top-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-code/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-donate/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search-pro/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-tbfed-pagefooter/footer.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../coodex-junit-enhance/" />
    
    
    <link rel="prev" href="../coodex-mock/" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="输入并搜索" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../coodex-utilities/">
            
                <a href="../coodex-utilities/">
            
                    
                    coodex-utilities
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../coodex-utilities/org.coodex.util.Common.html">
            
                <a href="../coodex-utilities/org.coodex.util.Common.html">
            
                    
                    Common
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../coodex-utilities/org.coodex.util.Singleton.html">
            
                <a href="../coodex-utilities/org.coodex.util.Singleton.html">
            
                    
                    单例
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../coodex-utilities/org.coodex.util.ResourceScanner.html">
            
                <a href="../coodex-utilities/org.coodex.util.ResourceScanner.html">
            
                    
                    资源扫描器
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../coodex-utilities/SPI.html">
            
                <a href="../coodex-utilities/SPI.html">
            
                    
                    SPI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.5" data-path="../coodex-utilities/org.coodex.util.Profile.html">
            
                <a href="../coodex-utilities/org.coodex.util.Profile.html">
            
                    
                    Profile
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.6" data-path="../coodex-utilities/org.coodex.util.Config.html">
            
                <a href="../coodex-utilities/org.coodex.util.Config.html">
            
                    
                    Config
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.7" data-path="../coodex-utilities/org.coodex.util.Renderer.html">
            
                <a href="../coodex-utilities/org.coodex.util.Renderer.html">
            
                    
                    Renderer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.8" data-path="../coodex-utilities/org.coodex.util.I18N.html">
            
                <a href="../coodex-utilities/org.coodex.util.I18N.html">
            
                    
                    I18N 国际化
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.9" data-path="../coodex-utilities/org.coodex.util.Retry.html">
            
                <a href="../coodex-utilities/org.coodex.util.Retry.html">
            
                    
                    轻量级重试机制
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.10" data-path="../coodex-utilities/org.coodex.util.Tracer.html">
            
                <a href="../coodex-utilities/org.coodex.util.Tracer.html">
            
                    
                    Tracer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.11" data-path="../coodex-utilities/org.coodex.util.CRC.html">
            
                <a href="../coodex-utilities/org.coodex.util.CRC.html">
            
                    
                    CRC
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.12" data-path="../coodex-utilities/org.coodex.util.Polygon.html">
            
                <a href="../coodex-utilities/org.coodex.util.Polygon.html">
            
                    
                    Polygon 多边形工具
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.13" data-path="../coodex-utilities/org.coodex.util.Section.html">
            
                <a href="../coodex-utilities/org.coodex.util.Section.html">
            
                    
                    Section 线段
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.14" data-path="../coodex-utilities/org.coodex.util.clock.html">
            
                <a href="../coodex-utilities/org.coodex.util.clock.html">
            
                    
                    天上人间
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.15" data-path="../coodex-utilities/org.coodex.concurrent.html">
            
                <a href="../coodex-utilities/org.coodex.concurrent.html">
            
                    
                    并发通用库
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.16" data-path="../coodex-utilities/org.coodex.closure.html">
            
                <a href="../coodex-utilities/org.coodex.closure.html">
            
                    
                    闭包
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../coodex-mock/">
            
                <a href="../coodex-mock/">
            
                    
                    数据模拟
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4" data-path="./">
            
                <a href="./">
            
                    
                    计费框架
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../coodex-junit-enhance/">
            
                <a href="../coodex-junit-enhance/">
            
                    
                    junit强化
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本书使用 GitBook 发布
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >计费框架</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="coodex-billing">coodex billing</h1>
<p>&#x4E00;&#x4E2A;&#x53EF;&#x590D;&#x7528;&#x7684;&#x8BA1;&#x8D39;&#x6A21;&#x578B;&#x6846;&#x67B6;</p>
<h2 id="maven">maven</h2>
<pre><code class="lang-xml">            <span class="hljs-comment">&lt;!-- mock &#x89C4;&#x8303; --&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.coodex<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>coodex-billing<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>${coodex.libraries.version}<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span>
</code></pre>
<h2 id="&#x4E3B;&#x8981;&#x5BF9;&#x8C61;">&#x4E3B;&#x8981;&#x5BF9;&#x8C61;</h2>
<ul>
<li>Chargeable&#xFF0C;&#x53EF;&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;&#xFF0C;&#x4E3B;&#x8981;&#x8DDF;&#x4E1A;&#x52A1;&#x5BF9;&#x5E94;&#xFF0C;&#x7531;&#x5176;&#x51B3;&#x5B9A;&#x8BA1;&#x8D39;&#x7684;&#x9886;&#x57DF;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;&#x4E00;&#x6B21;KTV&#x6D88;&#x8D39;&#xFF0C;&#x4E00;&#x987F;&#x996D;&#x3001;&#x4E00;&#x6B21;&#x4F4F;&#x5BBF;&#x3001;&#x4E00;&#x6B21;&#x7F5A;&#x6B3E;&#x3001;&#x4E00;&#x6B21;&#x505C;&#x8F66;&#x7B49;&#x7B49;</li>
<li>Bill&#xFF0C;&#x4E00;&#x7B14;&#x8D26;&#x5355;&#xFF0C;&#x5305;&#x542B;&#x8BA1;&#x8D39;&#x660E;&#x7EC6;</li>
<li>Calculator&#xFF0C;&#x8D39;&#x7528;&#x8BA1;&#x7B97;&#x5668;&#xFF0C;&#x6839;&#x636E;&#x53EF;&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;&#x8BA1;&#x7B97;Bill</li>
<li>Revision&#xFF0C;&#x8BA1;&#x8D39;&#x65F6;&#x5BF9;&#x8BA1;&#x8D39;&#x7684;&#x8C03;&#x6574;&#x9879;&#x76EE;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;&#x4F18;&#x60E0;&#x5238;&#xFF0C;&#x5176;&#x4ED6;&#x6D88;&#x8D39;&#x62B5;&#x6263;&#xFF0C;&#x5305;&#x6708;&#x7B49;&#x7B49;</li>
<li>Adjustment&#xFF0C;&#x5BF9;&#x8D26;&#x5355;&#x7684;&#x8C03;&#x6574;&#x9879;&#x76EE;&#xFF0C;&#x4F8B;&#x5982;&#xFF1A;&#x8D26;&#x5355;&#x6BD4;&#x4F8B;&#x4F18;&#x60E0;&#xFF0C;&#x62B9;&#x96F6;&#xFF0C;&#x9644;&#x52A0;&#x8D39;&#x7B49;&#x7B49;</li>
</ul>
<h2 id="&#x6309;&#x91CF;&#x8BA1;&#x8D39;">&#x6309;&#x91CF;&#x8BA1;&#x8D39;</h2>
<p>&#x592A;&#x7B80;&#x5355;&#xFF0C;&#x4E0D;&#x591A;&#x8BF4;&#x3002;</p>
<h2 id="&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;">&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;</h2>
<p><code>coodex-billing</code>&#x4E3A;&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x6846;&#x67B6;&#xFF0C;&#x4E3B;&#x8981;&#x5BF9;&#x8C61;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>Period&#xFF0C;&#x65F6;&#x95F4;&#x6BB5;&#xFF0C;&#x5305;&#x542B;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#xFF0C;&#x7ED3;&#x675F;&#x65F6;&#x95F4;</li>
<li>TimeBasedChargeable&#xFF0C;&#x65F6;&#x5E8F;&#x53EF;&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;&#xFF0C;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x8D77;&#x6B62;&#x65F6;&#x95F4;&#x6BB5;&#xFF0C;&#x6A21;&#x578B;&#x7F16;&#x7801;&#xFF0C;&#x6A21;&#x578B;&#x53C2;&#x6570;id</li>
<li>TimeBasedBill&#xFF0C;&#x5305;&#x542B;&#x65F6;&#x95F4;&#x6BB5;&#x4FE1;&#x606F;&#x7684;&#x8D26;&#x5355;</li>
<li>TimeBasedDetail&#xFF0C;&#x5305;&#x542B;&#x65F6;&#x95F4;&#x6BB5;&#x4FE1;&#x606F;&#x7684;&#x8D26;&#x5355;&#x660E;&#x7EC6;</li>
<li>BillingModel&#xFF0C;&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;&#x7684;&#x6A21;&#x578B;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x5BF9;&#x5E94;&#x6307;&#x5B9A;&#x9886;&#x57DF;&#x4E2D;&#x4E00;&#x79CD;&#x5177;&#x4F53;&#x7684;&#x3001;&#x5B8C;&#x6574;&#x7684;&#x8BA1;&#x8D39;&#x89C4;&#x5219;</li>
<li>BillingModel.Instance&#xFF0C;&#x8BA1;&#x8D39;&#x6A21;&#x578B;&#x7684;&#x4E00;&#x4E2A;&#x5B9E;&#x4F8B;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x67D0;&#x8FDE;&#x9501;&#x5BBE;&#x9986;&#xFF0C;&#x4E0D;&#x540C;&#x5E97;&#x8BA1;&#x8D39;&#x6A21;&#x5F0F;&#x76F8;&#x540C;&#xFF0C;&#x4F46;&#x662F;&#x5355;&#x4EF7;&#x4E0D;&#x540C;&#xFF0C;&#x6BCF;&#x4E2A;&#x5E97;&#x7684;&#x8BA1;&#x8D39;&#x6807;&#x51C6;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x6A21;&#x578B;&#x5B9E;&#x4F8B;</li>
<li>BillingModel.Algorithm&#xFF0C;&#x67D0;&#x4E00;&#x4E2A;&#x65F6;&#x6BB5;&#x7684;&#x8BA1;&#x8D39;&#x6CD5;&#x5219;</li>
<li>BillingModel.Fragment&#xFF0C;&#x8BA1;&#x8D39;&#x6BB5;&#x3002;&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;&#x65F6;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x628A;&#x4E00;&#x4E2A;&#x8FDE;&#x7EED;&#x65F6;&#x957F;&#x6309;&#x7167;&#x6807;&#x51C6;&#x5207;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x65F6;&#x6BB5;&#xFF0C;&#x9010;&#x4E00;&#x8BA1;&#x7B97;&#x3002;&#x65F6;&#x5E8F;&#x6BB5;&#x5305;&#x542B;&#x4E00;&#x4E2A;&#x8BA1;&#x8D39;&#x6CD5;&#x5219;&#x548C;&#x4E00;&#x4E2A;&#x65F6;&#x95F4;&#x6BB5;</li>
<li>TimeBasedRevision&#xFF0C;&#x65F6;&#x5E8F;&#x7684;&#x8C03;&#x6574;&#x9879;&#x76EE;<ul>
<li>WholeTimeRevision&#xFF0C;&#x5207;&#x5206;&#x524D;&#x8C03;&#x6574;</li>
<li>FragmentRevision&#xFF0C;&#x57FA;&#x4E8E;&#x7279;&#x5B9A;&#x8BA1;&#x8D39;&#x6BB5;&#x7684;&#x8C03;&#x6574;</li>
</ul>
</li>
</ul>
<p><code>coodex-billing</code>&#x4E5F;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x65F6;&#x5E8F;&#x8BA1;&#x8D39;&#x6A21;&#x578B;&#x7684;&#x53C2;&#x8003;&#x5B9E;&#x73B0;&#xFF0C;&#x65B9;&#x4FBF;&#x5F00;&#x53D1;&#x8005;&#x4F7F;&#x7528;&#xFF0C;&#x53C2;&#x8003;&#x5B9E;&#x73B0;&#x7684;&#x7EA6;&#x5B9A;&#x5305;&#x62EC;&#xFF1A;</p>
<ul>
<li>AbstractAlgorithm<ul>
<li>&#x589E;&#x52A0;&#x4E86;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x4E0D;&#x8FDE;&#x7EED;&#x65F6;&#x6BB5;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x4E00;&#x4E2A;&#x8BA1;&#x8D39;&#x6BB5;&#x662F;[11:00 - 23:00]&#xFF0C;&#x6D88;&#x8D39;&#x7684;&#x65F6;&#x6BB5;&#x4E3A;[12:00 - 20:00]&#xFF0C;&#x4F7F;&#x7528;&#x4E00;&#x5F20;[14:00 - 15:00]&#x62B5;&#x6263;&#x7684;&#x4F18;&#x60E0;&#x5377;&#xFF0C;&#x90A3;&#x4E48;&#x6B64;&#x8BA1;&#x8D39;&#x6BB5;&#x5185;&#x9700;&#x8981;&#x8BA1;&#x8D39;&#x7684;&#x65F6;&#x6BB5;&#x53D8;&#x6210;&#x4E86;[12:00 - 14:00]&#x548C;[15:00 - 20:00]&#xFF0C;&#x8BE5;&#x5C5E;&#x6027;&#x4E3A;&#x771F;&#x65F6;&#xFF0C;&#x8BA1;&#x8D39;&#x65F6;&#x957F;&#x4E3A;7&#x5C0F;&#x65F6;&#xFF0C;&#x5426;&#x5219;&#xFF0C;&#x4F1A;&#x5206;&#x4E24;&#x6B21;&#x8BA1;&#x7B97;&#xFF0C;&#x53EF;&#x6839;&#x636E;&#x8BA1;&#x8D39;&#x6807;&#x51C6;&#x6307;&#x5B9A;</li>
</ul>
</li>
<li>AbstractBillingModel&#xFF0C;&#x8BA1;&#x8D39;&#x6A21;&#x578B;&#x7684;&#x53C2;&#x8003;&#x5B9E;&#x73B0;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x53EA;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x5177;&#x4F53;&#x7684;TimeBasedChargeable&#x8BB0;&#x5FC6;&#x6A21;&#x578B;&#x7684;&#x7F16;&#x7801;&#x5373;&#x53EF;</li>
<li>ModelProfileFactory&#xFF0C;&#x6A21;&#x578B;&#x53C2;&#x6570;&#x4ED3;&#x5E93;&#xFF0C;&#x5F00;&#x53D1;&#x8005;&#x81EA;&#x884C;&#x5B9E;&#x73B0;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x4E0D;&#x540C;&#x6A21;&#x578B;&#x7684;&#x53D8;&#x91CF;&#x7ED3;&#x6784;&#x662F;&#x4E0D;&#x4E00;&#x6837;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x4E3A;&#x6BCF;&#x4E2A;&#x6A21;&#x578B;&#x89C1;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x8868;&#xFF0C;&#x7136;&#x540E;&#x6839;&#x636E;id&#x6765;&#x63D0;&#x53D6;&#x6570;&#x636E;</li>
<li>FragmentSlicer&#xFF0C;&#x8BA1;&#x8D39;&#x6BB5;&#x5207;&#x7247;&#x5668;&#xFF0C;<code>coodex-billing</code>&#x63D0;&#x4F9B;&#x4E86;3&#x949F;&#x5F00;&#x7BB1;&#x5373;&#x7528;&#x7684;&#x5207;&#x7247;&#x5668;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;SlicerProfile/SlicerFactory&#x81EA;&#x884C;&#x6269;&#x5C55;<ul>
<li>&#x6309;&#x81EA;&#x7136;&#x65E5;&#x5207;&#x7247;(FxiedDateSlicerProfile&#xFF0C;FxiedDateSlicerFactory)&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4ECE;&#x6BCF;&#x5929;&#x7684;&#x4F55;&#x65F6;&#x5F00;&#x59CB;&#x8FDB;&#x884C;&#x5207;&#x7247;&#xFF0C;&#x9ED8;&#x8BA4;&#x4ECE;0&#x70B9;&#x5F00;&#x59CB;</li>
<li>&#x56FA;&#x5B9A;&#x5C0F;&#x65F6;&#x6570;&#x5207;&#x7247;(FixedHoursSlicerProfile, FixedHoursSlicerFactory)&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x591A;&#x5C11;&#x5C0F;&#x65F6;&#x4E00;&#x6BB5;&#xFF0C;&#x4E0D;&#x5F97;&#x5C0F;&#x4E8E;1</li>
<li>&#x65F6;&#x6BB5;&#x5207;&#x7247;(FragmentSlicerProfile&#xFF0C;FragmentSlicerFactory)&#xFF0C;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4ECE;&#x4F55;&#x65F6;&#x5230;&#x4F55;&#x65F6;&#x8FDB;&#x884C;&#x5207;&#x7247;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;00:00 - 04:00&#x3002;&#x5F53;&#x5F00;&#x59CB;&#x65F6;&#x95F4;&#x63CF;&#x8FF0;&#x5927;&#x4E8E;&#x7ED3;&#x675F;&#x65F6;&#x95F4;&#x63CF;&#x8FF0;&#x65F6;&#xFF0C;&#x8BF4;&#x660E;&#x7ED3;&#x675F;&#x65F6;&#x95F4;&#x4E3A;&#x6B21;&#x65E5;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;20:00 - 08:00&#xFF0C;&#x8868;&#x793A;&#x5F53;&#x65E5;20:00&#x5230;&#x6B21;&#x65E5;&#x7684;08:00</li>
</ul>
</li>
<li>&#x8BA1;&#x8D39;&#x89C4;&#x5219;&#x4F53;&#x7CFB;&#xFF0C;&#x4F7F;&#x7528;&#x8BA1;&#x8D39;&#x53C2;&#x6570;(AlgorithmProfile)&#x53CA;&#x8BA1;&#x8D39;&#x5B9E;&#x4F8B;&#x5DE5;&#x5382;(AlgorithmFactory)&#x81EA;&#x884C;&#x5B9E;&#x73B0;</li>
</ul>
<h3 id="&#x5B9E;&#x8DF5;&#x793A;&#x4F8B;">&#x5B9E;&#x8DF5;&#x793A;&#x4F8B;</h3>
<p>&#x6211;&#x4EEC;&#x4EE5;&#x4E00;&#x4E2A;&#x6309;&#x65F6;&#x8BA1;&#x8D39;&#x7684;KTV&#x4E3A;&#x6848;&#x4F8B;&#x5B9E;&#x8DF5;&#x4E00;&#x904D;&#xFF0C;&#x7531;&#x6D45;&#x5165;&#x6DF1;&#xFF0C;&#x4E00;&#x70B9;&#x70B9;&#x6269;&#x5C55;&#xFF0C;&#x6700;&#x7EC8;&#x8FBE;&#x5230;<code>&#x6708;&#x6708;&#x9E1F;</code>&#x5728;&#x67D0;KTV&#x4E2D;&#x5305;&#x6D88;&#x8D39;&#x4E00;&#x6BB5;&#x65F6;&#x957F;&#xFF0C;&#x5E76;&#x989D;&#x5916;&#x6D88;&#x8D39;&#x4E86;XX&#xFF0C;&#x4F7F;&#x7528;&#x591A;&#x4F18;&#x60E0;&#x5238;&#x3001;VIP&#x3001;&#x5305;&#x65F6;&#x6BB5;&#x6765;&#x51FA;&#x7ED3;&#x7B97;&#x5355;&#x7684;&#x573A;&#x666F;</p>
<p>&#x8BDD;&#x8BF4;&#xFF0C;<code>&#x6708;&#x6708;&#x9E1F;</code>&#x7AE5;&#x978B;&#x5FD9;&#x5B8C;&#x4E86;&#x4E00;&#x4E2A;&#x9879;&#x76EE;&#xFF0C;&#x62FF;&#x5230;&#x4E00;&#x7B14;&#x4E30;&#x539A;&#x7684;&#x5956;&#x91D1;&#xFF0C;&#x51C6;&#x5907;&#x7292;&#x52B3;&#x7292;&#x52B3;&#x81EA;&#x5DF1;&#xFF0C;&#x5728;&#x5927;&#x8857;&#x4E0A;&#x8D70;&#x7740;&#x8D70;&#x7740;&#x5C31;&#x8D70;&#x8FDB;&#x4E86;&#x4E4B;&#x524D;&#x5E38;&#x6765;&#x7684;&#x4E00;&#x5BB6;KTV&#xFF0C;&#x8FDB;&#x95E8;&#x4EE5;&#x540E;&#x5C31;&#x770B;&#x89C1;&#x6536;&#x8D39;&#x6807;&#x51C6;&#x5982;&#x4E0B;&#xFF1A;</p>
<blockquote>
<table>
<thead>
<tr>
<th>&#x65F6;&#x95F4;&#x6BB5;</th>
<th>&#x5927;&#x5305;</th>
<th>&#x4E2D;&#x5305;</th>
<th>&#x5C0F;&#x5305;</th>
</tr>
</thead>
<tbody>
<tr>
<td>02:00 - 08:00</td>
<td>228&#x5143;/&#x5C0F;&#x65F6;</td>
<td>128&#x5143;/&#x5C0F;&#x65F6;</td>
<td>88&#x5143;/&#x5C0F;&#x65F6;</td>
</tr>
<tr>
<td>08:00 - 18:00</td>
<td>118&#x5143;/&#x5C0F;&#x65F6;</td>
<td>68&#x5143;/&#x5C0F;&#x65F6;</td>
<td>48&#x5143;/&#x5C0F;&#x65F6;</td>
</tr>
<tr>
<td>18:00 - &#x6B21;&#x65E5;02:00</td>
<td>448&#x5143;/&#x5C0F;&#x65F6;</td>
<td>248&#x5143;/&#x5C0F;&#x65F6;</td>
<td>168&#x5143;/&#x5C0F;&#x65F6;</td>
</tr>
</tbody>
</table>
<p>* &#x52A0;&#x5165;VIP/VVIP&#x4EAB;&#x53D7;&#x66F4;&#x591A;&#x4F18;&#x60E0;&#xFF0C;&#x8BE6;&#x60C5;&#x8BF7;&#x54A8;&#x8BE2;&#x524D;&#x53F0;</p>
</blockquote>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#x7AE5;&#x978B;&#x5FC3;&#x60F3;&#xFF0C;&#x4E0A;&#x6B21;&#x7684;&#x5C0F;&#x5305;&#x817E;&#x632A;&#x4E0D;&#x5F00;&#xFF0C;&#x8FD9;&#x6B21;&#x6709;&#x94B1;&#x4E86;&#xFF0C;&#x6765;&#x4E2A;&#x4E2D;&#x5305;&#x5427;&#x3002;</p>
<p>&#x4E09;&#x5929;&#x4EE5;&#x540E;&#xFF0C;<code>&#x6708;&#x6708;&#x9E1F;</code>&#x6EE1;&#x610F;&#x7684;&#x6765;&#x5230;&#x524D;&#x53F0;&#x7ED3;&#x7B97;&#xFF0C;OK&#xFF0C;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x3002;</p>
<h4 id="&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;">&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;</h4>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.Revision;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.Period;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.TimeBasedChargeable;
<span class="hljs-keyword">import</span> org.coodex.util.Common;

<span class="hljs-keyword">import</span> java.text.ParseException;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.coodex.billing.demo.Constants.MODEL_01;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KTVConsumption</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">TimeBasedChargeable</span> </span>{

    <span class="hljs-keyword">public</span> <span class="hljs-keyword">enum</span> Room{
        LARGE, MIDDLE, SMALL
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> </span>{
        KTVConsumption ktvConsumption = <span class="hljs-keyword">new</span> KTVConsumption();
        Bill&lt;KTVConsumption&gt; bill = BillCalculator.calc(ktvConsumption);
        StringBuilder builder = <span class="hljs-keyword">new</span> StringBuilder(<span class="hljs-string">&quot;`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; &quot;</span>)
                .append(bill.getAmount()).append(<span class="hljs-string">&quot; &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;&quot;</span>);
        <span class="hljs-keyword">for</span> (Bill.Detail detail : bill.getDetails()) {
            builder.append(<span class="hljs-string">&quot;\n  &quot;</span>);
            <span class="hljs-keyword">if</span> (detail <span class="hljs-keyword">instanceof</span> TimeBasedDetail) {
                TimeBasedDetail timeBasedDetail = (TimeBasedDetail) detail;
                builder.append(<span class="hljs-string">&quot;[&quot;</span>)
                        .append(Common.calendarToStr(timeBasedDetail.getPeriod().getStart()))
                        .append(<span class="hljs-string">&quot; - &quot;</span>)
                        .append(Common.calendarToStr(timeBasedDetail.getPeriod().getEnd()))
                        .append(<span class="hljs-string">&quot;]&quot;</span>);
            }
            builder.append(detail.item()).append(<span class="hljs-string">&quot; &#x91D1;&#x989D;: &quot;</span>).append(detail.getAmount()).append(<span class="hljs-string">&quot;&#x5143;&quot;</span>);
            <span class="hljs-keyword">if</span> (detail.usedRevision() != <span class="hljs-keyword">null</span>) {
                builder.append(<span class="hljs-string">&quot; &quot;</span>).append(detail.usedRevision().getName());
            }
        }
        System.out.println(builder.toString());
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Period <span class="hljs-title">getPeriod</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">try</span> {
            <span class="hljs-keyword">return</span> Period.BUILDER.create(
                    Common.strToCalendar(<span class="hljs-string">&quot;2019-09-18 16:47:30&quot;</span>, Common.DEFAULT_DATETIME_FORMAT),
                    Common.strToCalendar(<span class="hljs-string">&quot;2019-09-21 20:50:00&quot;</span>, Common.DEFAULT_DATETIME_FORMAT)
            );
        } <span class="hljs-keyword">catch</span> (ParseException e) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> RuntimeException(e.getLocalizedMessage(), e);
        }
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getModel</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> MODEL_01;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getModelParam</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> MODEL_01 + <span class="hljs-string">&quot;_01&quot;</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setModelParam</span><span class="hljs-params">(String modelParam)</span> </span>{
        <span class="hljs-comment">// &#x591A;&#x6761;&#x89C4;&#x5219;&#x65F6;&#x4F7F;&#x7528;</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setModel</span><span class="hljs-params">(String model)</span> </span>{
        <span class="hljs-comment">// &#x591A;&#x6761;&#x89C4;&#x5219;&#x65F6;&#x4F7F;&#x7528;</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setPeriod</span><span class="hljs-params">(Period period)</span> </span>{
        <span class="hljs-comment">// &#x591A;&#x6761;&#x89C4;&#x5219;&#x65F6;&#x4F7F;&#x7528;</span>
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> String <span class="hljs-title">getRefId</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&#x6708;&#x6708;&#x9E1F;&quot;</span>;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// &#x6682;&#x4E0D;&#x4F7F;&#x7528;&#x4F18;&#x60E0;</span>
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> Room <span class="hljs-title">getRoomType</span><span class="hljs-params">()</span></span>{
        <span class="hljs-keyword">return</span> Room.MIDDLE;
    }
}
</code></pre>
<blockquote>
<p>&#x8BF4;&#x660E;&#x4E00;&#x4E0B;&#xFF0C;&#x6B64;&#x5904;&#x6211;&#x4EEC;&#x6CA1;&#x6709;&#x901A;&#x8FC7;&#x5916;&#x90E8;&#x8BBE;&#x7F6E;&#x4E1A;&#x52A1;&#x5BF9;&#x8C61;&#xFF0C;&#x5B9E;&#x9645;&#x4E1A;&#x52A1;&#x573A;&#x666F;&#x4E2D;&#xFF0C;&#x9700;&#x8981;&#x7531;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x6839;&#x636E;&#x6570;&#x636E;&#x6784;&#x5EFA;&#x53EF;&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;</p>
</blockquote>
<h4 id="ktvconsumption&#x9886;&#x57DF;&#x4E0B;&#x7684;&#x8D26;&#x5355;&#x8BA1;&#x7B97;&#x5668;"><code>KTVConsumption</code>&#x9886;&#x57DF;&#x4E0B;&#x7684;&#x8D26;&#x5355;&#x8BA1;&#x7B97;&#x5668;</h4>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.timebased.AbstractTimeBasedCalculator;

<span class="hljs-keyword">import</span> java.util.concurrent.TimeUnit;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KTVBillCalculator</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractTimeBasedCalculator</span>&lt;<span class="hljs-title">KTVConsumption</span>&gt; </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> TimeUnit <span class="hljs-title">getTimeUnit</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> TimeUnit.MINUTES;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> KTVConsumption <span class="hljs-title">copyChargeable</span><span class="hljs-params">(KTVConsumption chargeable, List&lt;Revision&gt; revisions)</span> </span>{
        <span class="hljs-keyword">return</span> chargeable;
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">accept</span><span class="hljs-params">(KTVConsumption param)</span> </span>{
        <span class="hljs-keyword">return</span> param != <span class="hljs-keyword">null</span>;
    }
}
</code></pre>
<p>&#x653E;&#x5165;&#x5230;<code>SPI</code>:<code>META-INF/services/org.coodex.billing.Calculator</code></p>
<pre><code class="lang-txt">org.coodex.billing.demo.KTVBillCalculator
</code></pre>
<h4 id="model01&#x8BA1;&#x8D39;&#x6A21;&#x578B;">MODEL_01&#x8BA1;&#x8D39;&#x6A21;&#x578B;</h4>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.AbstractBillingModel;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.coodex.billing.demo.Constants.MODEL_01;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Model01</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">AbstractBillingModel</span>&lt;<span class="hljs-title">KTVConsumption</span>&gt; </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">protected</span> String <span class="hljs-title">getModelCode</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> MODEL_01;
    }
}
</code></pre>
<p>&#x653E;&#x5165;&#x5230;<code>SPI</code>:<code>META-INF/services/org.coodex.billing.timebased.BillingModel</code></p>
<pre><code class="lang-txt">org.coodex.billing.demo.Model01
</code></pre>
<h4 id="&#x6A21;&#x578B;&#x53C2;&#x6570;&#x5DE5;&#x5382;">&#x6A21;&#x578B;&#x53C2;&#x6570;&#x5DE5;&#x5382;</h4>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.AlgorithmProfile;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.FragmentProfile;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.ModelProfile;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.ModelProfileFactory;

<span class="hljs-keyword">import</span> java.util.Arrays;
<span class="hljs-keyword">import</span> java.util.List;

<span class="hljs-keyword">import</span> <span class="hljs-keyword">static</span> org.coodex.billing.demo.Constants.MODEL_01;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Model01ProfileFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ModelProfileFactory</span> </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> ModelProfile <span class="hljs-title">build</span><span class="hljs-params">(String s)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> ModelProfile() {
            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> AlgorithmProfile <span class="hljs-title">getWholeTimeAlgorithmProfile</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">null</span>;
            }

            <span class="hljs-meta">@Override</span>
            <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;FragmentProfile&gt; <span class="hljs-title">getFragmentProfiles</span><span class="hljs-params">()</span> </span>{
                <span class="hljs-comment">// &#x4E00;&#x4F1A;&#x589E;&#x52A0;</span>
                <span class="hljs-keyword">return</span> Arrays.asList();
            }
        };
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">accept</span><span class="hljs-params">(String param)</span> </span>{
        <span class="hljs-keyword">return</span> param != <span class="hljs-keyword">null</span> &amp;&amp; param.equals(MODEL_01);
    }
}
</code></pre>
<p>&#x653E;&#x5165;&#x5230;<code>SPI</code>:<code>META-INF/services/org.coodex.billing.timebased.reference.ModelProfileFactory</code></p>
<pre><code class="lang-txt">org.coodex.billing.demo.Model01ProfileFactory
</code></pre>
<p>&#x597D;&#x4E86;&#xFF0C;&#x622A;&#x6B62;&#x5230;&#x76EE;&#x524D;&#x4F4D;&#x7F6E;&#xFF0C;&#x9488;&#x5BF9;KTV&#x6D88;&#x8D39;&#x9886;&#x57DF;&#x7684;&#x6A21;&#x578B;&#x6846;&#x67B6;&#x642D;&#x597D;&#x4E86;&#xFF0C;&#x8DD1;&#x4E00;&#x4E0B;</p>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 0 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-21 20:50:00]no algorithm found. &#x91D1;&#x989D;: 0&#x5143;
</code></pre>
<p>&#x4E0B;&#x9762;&#x5F00;&#x59CB;&#x5B8C;&#x6210;<code>&#x6708;&#x6708;&#x9E1F;</code>&#x770B;&#x5230;&#x7684;&#x8BA1;&#x8D39;&#x89C4;&#x5219;</p>
<h4 id="&#x8BA1;&#x8D39;&#x6CD5;&#x5219;">&#x8BA1;&#x8D39;&#x6CD5;&#x5219;</h4>
<ul>
<li>&#x8BA1;&#x8D39;&#x6CD5;&#x5219;&#x7684;&#x53D8;&#x91CF;</li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.AlgorithmProfile;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerHourAlgorithmProfile</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AlgorithmProfile</span> </span>{
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> priceLargeRoom;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> priceMiddleRoom;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> priceSmallRoom;

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">PerHourAlgorithmProfile</span><span class="hljs-params">(<span class="hljs-keyword">int</span> priceLargeRoom, <span class="hljs-keyword">int</span> priceMiddleRoom, <span class="hljs-keyword">int</span> priceSmallRoom)</span> </span>{
        <span class="hljs-keyword">this</span>.priceLargeRoom = priceLargeRoom;
        <span class="hljs-keyword">this</span>.priceMiddleRoom = priceMiddleRoom;
        <span class="hljs-keyword">this</span>.priceSmallRoom = priceSmallRoom;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPriceLargeRoom</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> priceLargeRoom;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPriceMiddleRoom</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> priceMiddleRoom;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPriceSmallRoom</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> priceSmallRoom;
    }
}
</code></pre>
<ul>
<li>&#x8BA1;&#x8D39;&#x6CD5;&#x5219;&#x5DE5;&#x5382;</li>
</ul>
<pre><code class="lang-java"><span class="hljs-keyword">package</span> org.coodex.billing.demo;

<span class="hljs-keyword">import</span> org.coodex.billing.Bill;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.AbstractTimeBasedCalculator;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.BillingModel;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.Period;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.AbstractAlgorithm;
<span class="hljs-keyword">import</span> org.coodex.billing.timebased.reference.AlgorithmFactory;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">PerHourAlgorithmFactory</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">AlgorithmFactory</span>&lt;<span class="hljs-title">KTVConsumption</span>, <span class="hljs-title">PerHourAlgorithmProfile</span>&gt; </span>{
    <span class="hljs-meta">@Override</span>
    <span class="hljs-keyword">public</span> BillingModel.<span class="hljs-function">Algorithm&lt;KTVConsumption&gt; <span class="hljs-title">build</span><span class="hljs-params">(<span class="hljs-keyword">final</span> PerHourAlgorithmProfile perHourAlgorithmProfile)</span> </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AbstractAlgorithm&lt;KTVConsumption&gt;() {

            <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> <span class="hljs-title">getPricePerHour</span><span class="hljs-params">(KTVConsumption ktvConsumption)</span> </span>{
                <span class="hljs-keyword">switch</span> (ktvConsumption.getRoomType()) {
                    <span class="hljs-keyword">case</span> LARGE:
                        <span class="hljs-keyword">return</span> perHourAlgorithmProfile.getPriceLargeRoom();
                    <span class="hljs-keyword">case</span> MIDDLE:
                        <span class="hljs-keyword">return</span> perHourAlgorithmProfile.getPriceMiddleRoom();
                    <span class="hljs-keyword">default</span>:
                        <span class="hljs-keyword">return</span> perHourAlgorithmProfile.getPriceSmallRoom();
                }
            }

            <span class="hljs-function"><span class="hljs-keyword">private</span> <span class="hljs-keyword">long</span> <span class="hljs-title">getPrice</span><span class="hljs-params">(KTVConsumption ktvConsumption, <span class="hljs-keyword">long</span> duration)</span> </span>{
                <span class="hljs-keyword">int</span> remainder = (<span class="hljs-keyword">int</span>) (duration % <span class="hljs-number">60</span>);
                <span class="hljs-keyword">int</span> quotient = (<span class="hljs-keyword">int</span>) (duration / <span class="hljs-number">60</span>);
                <span class="hljs-keyword">int</span> pricePerHour = getPricePerHour(ktvConsumption);
                <span class="hljs-keyword">return</span> quotient * pricePerHour + (remainder &gt; <span class="hljs-number">0</span> ? pricePerHour : <span class="hljs-number">0</span>);
            }

            <span class="hljs-function"><span class="hljs-keyword">private</span> String <span class="hljs-title">getItemName</span><span class="hljs-params">(KTVConsumption ktvConsumption)</span> </span>{
                <span class="hljs-keyword">switch</span> (ktvConsumption.getRoomType()) {
                    <span class="hljs-keyword">case</span> LARGE:
                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&#x5927;&#x5305;&#x5305;&#x95F4;&#x8D39;&quot;</span>;
                    <span class="hljs-keyword">case</span> MIDDLE:
                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39;&quot;</span>;
                    <span class="hljs-keyword">default</span>:
                        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;&#x5C0F;&#x5305;&#x5305;&#x95F4;&#x8D39;&quot;</span>;
                }
            }

            <span class="hljs-meta">@Override</span>
            <span class="hljs-keyword">protected</span> Bill.<span class="hljs-function">Detail <span class="hljs-title">calc</span><span class="hljs-params">(Period period, <span class="hljs-keyword">long</span> duration, KTVConsumption chargeable)</span> </span>{
                <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> AbstractTimeBasedCalculator.TimeBasedDetailImpl(
                        period,
                        getPrice(chargeable, duration),
                        getItemName(chargeable) + <span class="hljs-string">&quot; &#x6D88;&#x8D39; &quot;</span> + duration + <span class="hljs-string">&quot; &#x5206;&#x949F;&quot;</span>
                );
            }
        };
    }

    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">boolean</span> <span class="hljs-title">accept</span><span class="hljs-params">(PerHourAlgorithmProfile param)</span> </span>{
        <span class="hljs-keyword">return</span> param != <span class="hljs-keyword">null</span>;
    }
}
</code></pre>
<p>&#x653E;&#x5230;<code>SPI</code>:<code>META-INF/services/org.coodex.billing.timebased.reference.AlgorithmFactory</code></p>
<pre><code class="lang-txt">org.coodex.billing.demo.PerHourAlgorithmFactory
</code></pre>
<p>ok&#xFF0C;&#x8DD1;&#x4E00;&#x628A;&#x770B;&#x770B;</p>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 11176 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 72 &#x5206;&#x949F; &#x91D1;&#x989D;: 136&#x5143;
  [2019-09-18 18:00:00 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 20:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 170 &#x5206;&#x949F; &#x91D1;&#x989D;: 744&#x5143;
</code></pre>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#x4E00;&#x770B;&#xFF0C;&#x56AF;&#xFF0C;1&#x4E07;&#x591A;&#xFF0C;&#x5B8C;&#x4E86;&#x5B8C;&#x4E86;&#x5B8C;&#x4E86;&#xFF0C;&#x56DE;&#x5BB6;&#x6CA1;&#x6CD5;&#x4EA4;&#x5F85;&#x4E86;&#xFF0C;&#x8FD8;&#x597D;&#xFF0C;&#x6211;&#x6709;&#x5F20;6&#x6298;&#x5361;&#xFF0C;&#x8FD8;&#x6709;&#x4E0A;&#x6B21;&#x6D88;&#x8D39;&#x8FD4;&#x8FD8;&#x7684;2&#x5C0F;&#x65F6;&#x7684;&#x62B5;&#x6263;&#x65F6;&#x957F;&#x548C;1500&#x7684;&#x4EE3;&#x91D1;&#x5238;&#xFF0C;&#x518D;&#x7B97;&#x7B97;&#x3002;</p>
<h4 id="&#x4F18;&#x60E0;">&#x4F18;&#x60E0;</h4>
<p>&#x53EF;&#x8BA1;&#x8D39;&#x5BF9;&#x8C61;&#x91CC;&#xFF0C;&#x589E;&#x52A0;&#x8C03;&#x6574;&#x9879;&#xFF1A;</p>
<pre><code class="lang-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                <span class="hljs-keyword">new</span> DurationRevision(<span class="hljs-string">&quot;2&#x5C0F;&#x65F6;&#x62B5;&#x6263;&quot;</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TimeBasedOffAdjustment&lt;KTVConsumption&gt;(<span class="hljs-number">0.4f</span>, <span class="hljs-string">&quot;6&#x6298;&#x623F;&#x95F4;&#x8D39;&quot;</span>),
                <span class="hljs-keyword">new</span> AmountAdjustment(<span class="hljs-number">1500</span>, <span class="hljs-string">&quot;1500&#x5143;&#x4EE3;&#x91D1;&#x5238;&quot;</span>)
        );
    }
</code></pre>
<p>&#x597D;&#x7684;&#xFF0C;&#x518D;&#x770B;&#x770B;</p>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 5124 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:47:30]2&#x5C0F;&#x65F6;&#x62B5;&#x6263; &#x91D1;&#x989D;: 0&#x5143; 2&#x5C0F;&#x65F6;&#x62B5;&#x6263;
  [2019-09-18 18:47:30 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 432 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 20:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 170 &#x5206;&#x949F; &#x91D1;&#x989D;: 744&#x5143;
  6&#x6298;&#x623F;&#x95F4;&#x8D39; &#x91D1;&#x989D;: -4416&#x5143; 6&#x6298;&#x623F;&#x95F4;&#x8D39;
  1500&#x5143;&#x4EE3;&#x91D1;&#x5238; &#x91D1;&#x989D;: -1500&#x5143; 1500&#x5143;&#x4EE3;&#x91D1;&#x5238;
</code></pre>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#x8BF4;&#xFF1A; &#x4F60;&#x628A;&#x65F6;&#x957F;&#x4ECE;&#x540E;&#x9762;&#x51CF;&#x6389;&#x6211;&#x770B;&#x770B;&#xFF0C;&#x597D;&#x50CF;&#x4ECE;&#x540E;&#x9762;&#x51CF;&#x5408;&#x9002;&#x70B9;</p>
<p>&#x5E97;&#x5458;&#xFF1A;&#x6210;&#x5427;&#xFF0C;&#x770B;&#x5728;&#x4F60;&#x662F;&#x719F;&#x5BA2;&#xFF0C;&#x4E00;&#x822C;&#x4EBA;&#x6211;&#x53EF;&#x771F;&#x4E0D;&#x8FD9;&#x6837;</p>
<pre><code class="lang-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                <span class="hljs-keyword">new</span> DurationRevision(<span class="hljs-string">&quot;5&#x5C0F;&#x65F6;&#x62B5;&#x6263;&quot;</span>, <span class="hljs-number">120</span>&#xFF0C; <span class="hljs-keyword">false</span>),
                <span class="hljs-keyword">new</span> TimeBasedOffAdjustment&lt;KTVConsumption&gt;(<span class="hljs-number">0.4f</span>, <span class="hljs-string">&quot;6&#x6298;&#x623F;&#x95F4;&#x8D39;&quot;</span>),
                <span class="hljs-keyword">new</span> AmountAdjustment(<span class="hljs-number">1500</span>, <span class="hljs-string">&quot;1500&#x5143;&#x4EE3;&#x91D1;&#x5238;&quot;</span>)
        );
    }
</code></pre>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 4908 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 72 &#x5206;&#x949F; &#x91D1;&#x989D;: 136&#x5143;
  [2019-09-18 18:00:00 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 18:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 50 &#x5206;&#x949F; &#x91D1;&#x989D;: 248&#x5143;
  [2019-09-21 18:50:00 - 2019-09-21 20:50:00]2&#x5C0F;&#x65F6;&#x62B5;&#x6263; &#x91D1;&#x989D;: 0&#x5143; 2&#x5C0F;&#x65F6;&#x62B5;&#x6263;
  6&#x6298;&#x623F;&#x95F4;&#x8D39; &#x91D1;&#x989D;: -4272&#x5143; 6&#x6298;&#x623F;&#x95F4;&#x8D39;
  1500&#x5143;&#x4EE3;&#x91D1;&#x5238; &#x91D1;&#x989D;: -1500&#x5143; 1500&#x5143;&#x4EE3;&#x91D1;&#x5238;
</code></pre>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#xFF1A;&#x679C;&#x7136;&#xFF0C;&#x4ECE;&#x540E;&#x9762;&#x7B97;&#x5212;&#x7B97;&#xFF0C;&#x6765;&#x5427;&#xFF0C;&#x7ED3;&#x8D26;&#x5427;</p>
<p>&#x5E97;&#x5458;&#xFF1A;&#x7A0D;&#x7B49;&#xFF0C;&#x67E5;&#x623F;&#x9A6C;&#x4E0A;&#x7ED9;&#x7ED3;&#x679C;</p>
<h4 id="&#x989D;&#x5916;&#x6D88;&#x8D39;">&#x989D;&#x5916;&#x6D88;&#x8D39;</h4>
<p>&#x5E97;&#x5458;&#xFF1A;&#x4E0D;&#x597D;&#x610F;&#x601D;&#xFF0C;&#x60A8;&#x8FD8;&#x6D88;&#x8D39;&#x4E86;&#x65B9;&#x4FBF;&#x9762;10&#x76D2;&#xFF0C;XXX&#x4E03;&#x4E2A;&#x3002;&#x670D;&#x52A1;&#x5458;&#x7684;&#x6D88;&#x8D39;&#x60A8;&#x662F;&#x5355;&#x72EC;&#x7ED3;&#x8FD8;&#x662F;&#x4E00;&#x8D77;&#x7ED3;&#xFF1F;</p>
<pre><code class="lang-java">    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                <span class="hljs-keyword">new</span> DurationRevision(<span class="hljs-string">&quot;2&#x5C0F;&#x65F6;&#x62B5;&#x6263;&quot;</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TimeBasedOffAdjustment&lt;KTVConsumption&gt;(<span class="hljs-number">0.4f</span>, <span class="hljs-string">&quot;6&#x6298;&#x623F;&#x95F4;&#x8D39;&quot;</span>),
                <span class="hljs-keyword">new</span> AmountAdjustment(<span class="hljs-number">1500</span>, <span class="hljs-string">&quot;1500&#x5143;&#x4EE3;&#x91D1;&#x5238;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-string">&quot;&#x65B9;&#x4FBF;&#x9762;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-string">&quot;XXX&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">300</span>,<span class="hljs-number">5</span>,<span class="hljs-string">&quot;XMA&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">400</span>,<span class="hljs-number">2</span>,<span class="hljs-string">&quot;XMB&quot;</span>)
        );
    }
</code></pre>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 7629 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:47:30]2&#x5C0F;&#x65F6;&#x62B5;&#x6263; &#x91D1;&#x989D;: 0&#x5143; 2&#x5C0F;&#x65F6;&#x62B5;&#x6263;
  [2019-09-18 18:47:30 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 432 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 20:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 170 &#x5206;&#x949F; &#x91D1;&#x989D;: 744&#x5143;
  6&#x6298;&#x623F;&#x95F4;&#x8D39; &#x91D1;&#x989D;: -4416&#x5143; 6&#x6298;&#x623F;&#x95F4;&#x8D39;
  1500&#x5143;&#x4EE3;&#x91D1;&#x5238; &#x91D1;&#x989D;: -1500&#x5143; 1500&#x5143;&#x4EE3;&#x91D1;&#x5238;
  &#x65B9;&#x4FBF;&#x9762;[10 x 10.0] &#x91D1;&#x989D;: 100&#x5143; &#x65B9;&#x4FBF;&#x9762;[10 x 10.0]
  XXX[15 x 7.0] &#x91D1;&#x989D;: 105&#x5143; XXX[15 x 7.0]
  XMA[300 x 5.0] &#x91D1;&#x989D;: 1500&#x5143; XMA[300 x 5.0]
  XMB[400 x 2.0] &#x91D1;&#x989D;: 800&#x5143; XMB[400 x 2.0]
</code></pre>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#xFF1A;&#x670D;&#x52A1;&#x5458;&#x7ED3;&#x8FC7;&#x4E86;&#x3001;&#x7ED3;&#x8FC7;&#x4E86;&#xFF0C;&#x4E00;&#x6B21;&#x4E00;&#x7ED3;&#x7684;</p>
<p>&#x5E97;&#x5458;&#xFF1A;&#x597D;&#x7684;</p>
<pre><code class="lang-java">    <span class="hljs-meta">@Override</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                <span class="hljs-keyword">new</span> DurationRevision(<span class="hljs-string">&quot;2&#x5C0F;&#x65F6;&#x62B5;&#x6263;&quot;</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TimeBasedOffAdjustment&lt;KTVConsumption&gt;(<span class="hljs-number">0.4f</span>, <span class="hljs-string">&quot;6&#x6298;&#x623F;&#x95F4;&#x8D39;&quot;</span>),
                <span class="hljs-keyword">new</span> AmountAdjustment(<span class="hljs-number">1500</span>, <span class="hljs-string">&quot;1500&#x5143;&#x4EE3;&#x91D1;&#x5238;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-string">&quot;&#x65B9;&#x4FBF;&#x9762;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-string">&quot;XXX&quot;</span>)
        );
    }
</code></pre>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 5329 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:47:30]2&#x5C0F;&#x65F6;&#x62B5;&#x6263; &#x91D1;&#x989D;: 0&#x5143; 2&#x5C0F;&#x65F6;&#x62B5;&#x6263;
  [2019-09-18 18:47:30 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 432 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 20:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 170 &#x5206;&#x949F; &#x91D1;&#x989D;: 744&#x5143;
  6&#x6298;&#x623F;&#x95F4;&#x8D39; &#x91D1;&#x989D;: -4416&#x5143; 6&#x6298;&#x623F;&#x95F4;&#x8D39;
  1500&#x5143;&#x4EE3;&#x91D1;&#x5238; &#x91D1;&#x989D;: -1500&#x5143; 1500&#x5143;&#x4EE3;&#x91D1;&#x5238;
  &#x65B9;&#x4FBF;&#x9762;[10 x 10.0] &#x91D1;&#x989D;: 100&#x5143; &#x65B9;&#x4FBF;&#x9762;[10 x 10.0]
  XXX[15 x 7.0] &#x91D1;&#x989D;: 105&#x5143; XXX[15 x 7.0]
</code></pre>
<h4 id="&#x62B9;&#x96F6;">&#x62B9;&#x96F6;</h4>
<p><code>&#x6708;&#x6708;&#x9E1F;</code>&#xFF1A;&#x4F60;&#x628A;&#x96F6;&#x5934;&#x62B9;&#x4E86;&#x5427;</p>
<p>&#x5E97;&#x5458;&#xFF1A;&#x597D;&#x7684;</p>
<pre><code class="lang-java">    <span class="hljs-function"><span class="hljs-keyword">public</span> List&lt;Revision&gt; <span class="hljs-title">getRevisions</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-keyword">return</span> Arrays.asList(
                <span class="hljs-keyword">new</span> DurationRevision(<span class="hljs-string">&quot;2&#x5C0F;&#x65F6;&#x62B5;&#x6263;&quot;</span>, <span class="hljs-number">120</span>),
                <span class="hljs-keyword">new</span> TimeBasedOffAdjustment&lt;KTVConsumption&gt;(<span class="hljs-number">0.4f</span>, <span class="hljs-string">&quot;6&#x6298;&#x623F;&#x95F4;&#x8D39;&quot;</span>),
                <span class="hljs-keyword">new</span> AmountAdjustment(<span class="hljs-number">1500</span>, <span class="hljs-string">&quot;1500&#x5143;&#x4EE3;&#x91D1;&#x5238;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">10</span>,<span class="hljs-number">10</span>,<span class="hljs-string">&quot;&#x65B9;&#x4FBF;&#x9762;&quot;</span>),
                <span class="hljs-keyword">new</span> ConsumerGoods(<span class="hljs-number">15</span>,<span class="hljs-number">7</span>,<span class="hljs-string">&quot;XXX&quot;</span>),
                <span class="hljs-keyword">new</span> ZeroRemainderAdjustment(<span class="hljs-string">&quot;&#x62B9;&#x96F6;&quot;</span>,<span class="hljs-number">100</span>)
        );
    }
</code></pre>
<pre><code class="lang-txt">`&#x6708;&#x6708;&#x9E1F;`&#x5728;`KTV`&#x7684;&#x6D88;&#x8D39;&#x603B;&#x91D1;&#x989D; 5300 &#x5143;&#x3002;&#x660E;&#x7EC6;&#x5982;&#x4E0B;&#xFF1A;
  [2019-09-18 16:47:30 - 2019-09-18 18:47:30]2&#x5C0F;&#x65F6;&#x62B5;&#x6263; &#x91D1;&#x989D;: 0&#x5143; 2&#x5C0F;&#x65F6;&#x62B5;&#x6263;
  [2019-09-18 18:47:30 - 2019-09-19 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 432 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-19 02:00:00 - 2019-09-19 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-19 08:00:00 - 2019-09-19 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-19 18:00:00 - 2019-09-20 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-20 02:00:00 - 2019-09-20 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-20 08:00:00 - 2019-09-20 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-20 18:00:00 - 2019-09-21 02:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 480 &#x5206;&#x949F; &#x91D1;&#x989D;: 1984&#x5143;
  [2019-09-21 02:00:00 - 2019-09-21 08:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 360 &#x5206;&#x949F; &#x91D1;&#x989D;: 768&#x5143;
  [2019-09-21 08:00:00 - 2019-09-21 18:00:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 600 &#x5206;&#x949F; &#x91D1;&#x989D;: 680&#x5143;
  [2019-09-21 18:00:00 - 2019-09-21 20:50:00]&#x4E2D;&#x5305;&#x5305;&#x95F4;&#x8D39; &#x6D88;&#x8D39; 170 &#x5206;&#x949F; &#x91D1;&#x989D;: 744&#x5143;
  6&#x6298;&#x623F;&#x95F4;&#x8D39; &#x91D1;&#x989D;: -4416&#x5143; 6&#x6298;&#x623F;&#x95F4;&#x8D39;
  1500&#x5143;&#x4EE3;&#x91D1;&#x5238; &#x91D1;&#x989D;: -1500&#x5143; 1500&#x5143;&#x4EE3;&#x91D1;&#x5238;
  &#x65B9;&#x4FBF;&#x9762;[10 x 10.0] &#x91D1;&#x989D;: 100&#x5143; &#x65B9;&#x4FBF;&#x9762;[10 x 10.0]
  XXX[15 x 7.0] &#x91D1;&#x989D;: 105&#x5143; XXX[15 x 7.0]
  &#x62B9;&#x96F6; &#x91D1;&#x989D;: -29&#x5143; &#x62B9;&#x96F6;
</code></pre>
<p>&#x5E97;&#x5458;&#xFF1A;&#x4E00;&#x5171;5300&#xFF0C;&#x8001;&#x677F;&#x662F;&#x73B0;&#x91D1;&#x3001;&#x5237;&#x5361;&#x8FD8;&#x662F;&#x7535;&#x5B50;&#x652F;&#x4ED8;&#xFF1F;</p>
<footer class="page-footer"><span class="copyright">&#xA9; coodex.org 2014-2020 all right reserved&#xFF0C;powered by Gitbook</span><span class="footer-modification">File Modify: 
2020-05-11 14:17:26
</span></footer>
<script>console.log("plugin-popup....");document.onclick = function(e){ e.target.tagName === "IMG" && window.open(e.target.src,e.target.src)}</script><style>img{cursor:pointer}</style>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="../coodex-mock/" class="navigation navigation-prev " aria-label="Previous page: 数据模拟">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../coodex-junit-enhance/" class="navigation navigation-next " aria-label="Next page: junit强化">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"计费框架","level":"1.4","depth":1,"next":{"title":"junit强化","level":"1.5","depth":1,"path":"coodex-junit-enhance/README.md","ref":"coodex-junit-enhance/README.md","articles":[]},"previous":{"title":"数据模拟","level":"1.3","depth":1,"path":"coodex-mock/README.md","ref":"coodex-mock/README.md","articles":[]},"dir":"ltr"},"config":{"plugins":["back-to-top-button","chapter-fold","code","donate","github","ga","-lunr","-search","search-pro","tbfed-pagefooter","popup"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"tbfed-pagefooter":{"copyright":"&copy coodex.org 2014-2020","modify_label":"","modify_format":"YYYY-MM-DD HH:mm:ss"},"chapter-fold":{},"github":{"url":"https://github.com/coodex2016/coodex-libraries"},"search-pro":{},"popup":{},"code":{"copyButtons":true},"donate":{"alipay":"/images/donate_alipay.png","alipayText":"支付宝打赏","button":"好哒","title":"<strong><font size='7'>壕</font>，请用<font size='5'>金钱</font>尽情<font size='6'>羞辱</font>我<font size='7'>！</font></strong>","wechat":"/images/donate_wechat.png","wechatText":"微信打赏"},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"back-to-top-button":{},"ga":{"configuration":"auto","token":"UA-124592164-1"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","author":"Shen Hainan <jujus.shen@126.com>","pdf":{"pageNumbers":true,"fontSize":14,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":0,"left":0,"top":0,"bottom":0},"fondFamily":"微软雅黑"},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"coodex_version":"0.5.0-SNAPSHOT"},"title":"Coodex libraries","language":"zh-hans","gitbook":"*"},"file":{"path":"coodex-billing/README.md","mtime":"2020-05-11T06:17:26.692Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-10-14T02:25:42.916Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-back-to-top-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-chapter-fold/chapter-fold.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-code/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-donate/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/jquery.mark.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search-pro/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

