# coodex-mock-spec

尝试定义一种模拟数据的规范

## 设计思路

- 使用装饰模式
- 在类型或属性上定义模拟上下文
- 在属性上定义采用的模拟方式
- `@Mock`用来修饰模拟器被定制注解
- 所有的模拟器注解需要是运行时的，可作用于Field, Annotation_Type, Method上
- `@Mock.Declaration` 用来修饰模拟器声明配置信息，声明模拟器的方式有两种，优先级如下：
  - 如果配置信息的属性的值类型是`@Mock`修饰的，则以此属性名为key，以此属性值声明上下文模拟器，这种方式主要用于公用类，可以将共用类中明确类型的需要被注入的模拟器逐一定义出来，开发者根据实际情况指定模拟器即可
  - 属性上有`@Mock`修饰的注解时，则以此属性名为`key`，以此属性上的注解声明上下文模拟器，适用于共用类中，属性类型不明确的，由开发者在外层根据具体情况指定将用到的模拟器
- `@Mock.Sequence`用来在模拟上下文中定义序列模拟器，用于对集合、数组同一维度的元素进行序列模拟，在集合、数组的feild和方法上，可以使用`@Mock.Inject`使用此序列模拟器来构建元素
- `@Mock.Sequences`用来定义一组序列模拟器
- 单值模拟器作用于pojo属性(field/ getter/ setter)上时，类型匹配的或者集合、数组元素类型匹配时，则使用此单值模拟器
- `@Mock.Inject` 用来修饰属性，或者修饰`@Mock.Key` `@Mock.Value`，注入上下文中的模拟器
  - 重名的模拟器优先级上：
    - 在集合、数组的属性模拟上，上下文中同名的序列模拟器优先级高于其他单值模拟器
    - 多个相同类型（单值并且与当前需要模拟的类型匹配的、序列）模拟器，就近原则，越靠近将要模拟的属性则越优先
- `@Mock.Dimensions` `@Mock.Dimension`用来定义多维（含一维）集合、数组的维度模拟信息，确定各维度的数组大小，`@Mock.Dimensions` `@Mock.Dimension`同时使用时，采用`@Mock.Dimensions`
- `@Mock.Key` `@Mock.Value`用于修饰类似于Map.Entry<K,V>类型的数据的注解，可以通过外部增加类型的支持
  - 此二与单值模拟器或序列模拟器共同修饰自定义的注解，用以定义键、值的模拟策略，可以使用`@Mock.Inject`注入，优先级：注入 -> 定义；序列 -> 单值；多个单值时，第一个符合键或值类型的优先
- `@Mock.Designated`，使用指定`yaml`或`json`文件模拟数据，优先级最高
- `@Mock.Relation`，用来指定pojo的关联模拟策略，也就是被修饰的属性可以根据所依赖的属性值进行运算，最大可能保障模拟数据的真实性